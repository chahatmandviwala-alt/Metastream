<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ethereum Keystore Tool (Offline)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg: #fafbfc;
      --text: #0f172a;
      --muted:#475569;
      --border:#e2e8f0;
      --panel:#ffffff;
      --accent:#357CBA;
      --danger:#ef4444;
      --success:#22c55e;
      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
      --radius: 10px;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family:var(--sans);
      background:var(--bg);
      color:var(--text);
      min-height: 100vh;
      display:flex;
      flex-direction:column;
      -webkit-font-smoothing: antialiased;
    }

    .wrap{
      max-width: 600px;
      margin: 0 auto;
      padding: 32px 16px;
      width:100%;
      flex-grow: 1;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
    }

    .centered-header{
      text-align:center;
      margin-bottom: 18px;
    }
    .centered-header h1{
      font-size: 1.42rem;
      margin: 4px 0 8px 0;
      font-weight: 700;
    }
    .subheading{
      color: var(--muted);
      font-size: 1.1rem;
      margin: 0;
      line-height: 1.35;
    }

    .section{
      background: var(--panel);
      border: 3px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      width:100%;
    }

    /* Tab panes */
    .pane{
      display:none;
      animation: fadeIn 0.2s ease;
    }
    .pane.active{ display:block; }
    @keyframes fadeIn{
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Segmented control */
    .tabs{
      display:flex;
      gap: 6px;
      padding: 6px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: rgba(2,6,23,0.02);
      margin-bottom: 16px;
    }
    .tab{
      flex: 1;
      text-align:center;
      padding: 10px 12px;
      border-radius: 10px;
      cursor:pointer;
      user-select:none;
      font-weight: 700;
      font-size: 1rem;
      color: var(--muted);
      border: 1px solid transparent;
    }
    .tab:hover{
      color: var(--text);
      border-color: rgba(14,165,233,0.25);
      background: rgba(14,165,233,0.06);
    }
    .tab.active{
      background: var(--panel);
      color: var(--text);
      border-color: var(--border);
    }

    label{ display:block; font-weight:600; margin: 10px 0 6px; }

    input[type="text"],
    input[type="password"],
    textarea,
    input[type="file"]{
      width:100%;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: transparent;
      color: inherit;
      outline: none;
      font-family: var(--sans);
      font-size: 0.95rem;
    }

    textarea{ min-height: 84px; resize: vertical; margin-bottom: 6px; }

    input:focus, textarea:focus{
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent);
    }

    input::placeholder, textarea::placeholder{ color: #94a3b8; }

    .hint{
      color: var(--muted);
      font-size: 0.85rem;
      margin-top: 6px;
      line-height: 1.35;
    }

    .row{
      display:flex;
      align-items:center;
      gap: 10px;
      margin-top: 10px;
    }
    input[type="checkbox"]{
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
      cursor: pointer;
    }
    .row label{
      margin: 0;
      font-weight: 600;
      color: var(--muted);
      cursor: pointer;
    }

    .flex{
      display:flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items:center;
      margin-top: 12px;
    }

    .btn{
      display:inline-block;
      padding: 10px 14px;
      border-radius: 8px;
      border: 1px solid var(--accent);
      color:#fff;
      background: var(--accent);
      font-weight: 600;
      cursor:pointer;
      box-shadow: none;
      text-decoration: none; /* allows <a> to look like button */
    }
    .btn.secondary{
      background: transparent;
      color: var(--accent);
      border-color: var(--border);
    }
    .btn.secondary:hover{ border-color: rgba(14,165,233,0.45); }
    .btn:disabled{ opacity: 0.65; cursor:not-allowed; }

    .warning{
      margin-top: 12px;
	  margin-bottom: 18px;
      padding: 6px;
      border-radius: 8px;
      border: 1px solid rgba(239, 68, 68, 0.25);
      background: rgba(239, 68, 68, 0.06);
      color: #b91c1c;
      font-size: 0.85rem;
      line-height: 1.35;
    }

    .output{
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: rgba(2,6,23,0.02);
      font-family: var(--mono);
      font-size: 0.98rem;
      white-space: pre-wrap;
      word-break: break-word;
      max-height: 150px;
      overflow-y: auto;
      display:none;
    }
    #createOutput{ max-height: 150px; }
    .output.success{ border-left: 3px solid var(--success); }
    .output.error{ border-left: 3px solid var(--danger); color: #b91c1c; }

    .footer-note{
      margin-top: 20px;
      text-align:center;
      font-size: 0.8rem;
      color: var(--muted);
    }

    input[type="file"]{
      padding: 8px;
      font-family: var(--sans);
    }
    input[type="file"]::file-selector-button{
      background: transparent;
      color: var(--text);
      border: 1px solid var(--border);
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
      margin-right: 12px;
      font-family: var(--sans);
    }

    @media (max-width: 600px){
      .wrap{ padding: 24px 14px; }
      .flex{ flex-direction: column; align-items: stretch; }
      .btn{ width:100%; }
    }
	
	.responsive-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

.field {
  width: 100%;
}

.label-row-main {
  width: 100%;
  display: flex;
  align-items: baseline;
  justify-content: space-between; /* pushes Show to the far right */
  gap: 12px;
  margin-bottom: 6px;
  margin-top: -8px;
}


.label-row {
  width: 100%;
  display: flex;
  align-items: baseline;
  justify-content: space-between; /* pushes Show to the far right */
  gap: 12px;
  margin-bottom: 6px;
}

.field-label {
  font-size: 18px;
  margin-bottom: 2px;
}

.text-toggle {
  font-size: 13px;
  padding: 2px 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  background-color: #f8f8f8;
  color: #333;
  margin-top: 16px;
  cursor: pointer;
  white-space: nowrap;
  margin-right: 2px; /* inset from edge */
}

.text-toggle:hover {
  background-color: #eee;
}

.text-toggle:active {
  background-color: #e0e0e0;
}

.text-toggle:focus {
  outline: none;
}

.label-with-info{
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

/* Info icon */
.info-icon{
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  font-size: 12px;
  font-weight: 500;
  color: var(--muted);
  border: 1px solid var(--border);
  border-radius: 50%;
  cursor: help;
  line-height: 1;
}

/* Tooltip */
.info-icon .tooltip{
  position: absolute;
  bottom: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  min-width: 260px;
  max-width: 320px;
  padding: 10px 12px;
  background: var(--panel);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 8px;
  font-size: 0.85rem;
  line-height: 1.35;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  opacity: 0;
  pointer-events: none;
  transition: opacity 120ms ease, transform 120ms ease;
  z-index: 10;
}

/* Tooltip arrow */
.info-icon .tooltip::after{
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  border-width: 6px;
  border-style: solid;
  border-color: var(--border) transparent transparent transparent;
}

/* Show on hover / focus */
.info-icon:hover .tooltip,
.info-icon:focus .tooltip{
  opacity: 1;
  transform: translateX(-50%) translateY(-2px);
}

/* Code styling inside tooltip */
.tooltip code{
  font-family: var(--mono);
  font-size: 0.85rem;
  background: rgba(2,6,23,0.05);
  padding: 2px 4px;
  border-radius: 4px;
}

	
  </style>
</head>
<body>

<div class="wrap" id="wrap">
  <header class="centered-header">
    <h1>Keystore Tool</h1>
    <p class="subheading">Create or decrypt an encrypted Ethereum keystore file.</p>
  </header>

  <section class="section">
    <div class="tabs">
      <div class="tab active" data-target="create">Create Keystore</div>
      <div class="tab" data-target="decrypt">Decrypt Keystore</div>
    </div>

    <div id="create" class="pane active">
      <div class="field">
		<div class="label-row-main">
			<label for="mnemonic" class="field-label">Seed phrase</label>
			<button
			type="button"
			id="toggleMnemonic"
			class="text-toggle"
			>
			Show
			</button>
		</div>

		<textarea
			id="mnemonic"
			placeholder="Enter your 12/15/18/21/24 word mnemonic seed phrase"
		></textarea>
	</div>

<div class="responsive-row">

  <!-- Passphrase -->
  <div class="field">
    <div class="label-row">
      <label for="mnemonicPassphrase" class="field-label">Passphrase
	  		           <span class="info-icon" tabindex="0" aria-label="Derivation path information">
          ⓘ
          <span class="tooltip">
            Leave it blank if you do not know what a passphrase is.
          </span>
        </span>
		</label>
      <button
        type="button"
        id="toggleMnemonicPassphrase"
        class="text-toggle"
      >
        Show
      </button>
    </div>

    <input
      type="password"
      id="mnemonicPassphrase"
      placeholder="Enter passphrase (optional)"
    />
  </div>

  <!-- Derivation path -->
  <div class="field">
    <label for="derivationPath" class="label-with-info" style="font-size: 18px;">
  Derivation path
  <span class="info-icon" tabindex="0" aria-label="Derivation path information">
    ⓘ
    <span class="tooltip">
      Default path for Ethereum wallets is <code>m/44'/60'/0'/0/0</code>.
      Do not change if you do not know what a derivation path is.
    </span>
  </span>
</label>

    <input
      type="text"
      id="derivationPath"
      value="m/44'/60'/0'/0/0"
      style="margin-top: 4px;"
    />
  </div>

</div>


<div class="field">
  <div class="label-row style="margin-top: 16px;">
    <label for="createPassword" class="field-label">Keystore password      
		<span class="info-icon" tabindex="0" aria-label="Keystore password information">
			ⓘ
        <span class="tooltip">
          This password will be used to encrypt the wallet as a keystore (.json) file. The encryption process may take approximately 5 seconds.
          The wallet can never be recovered if the password is lost.
        </span>
      </span>
	</label>
    <button type="button" id="toggleCreatePassword" class="text-toggle">Show</button>
  </div>

  <input
    type="password"
    id="createPassword"
    placeholder="Use a strong password. Never reuse it anywhere else."
  >
</div>

      <div class="flex">
        <button id="btnCreate" class="btn">Encrypt</button>

        <!-- Appears only after successful encrypt, between Encrypt and Reset -->
        <a id="downloadLink" class="btn secondary" style="display:none;" role="button">Download keystore</a>

        <!-- Hidden until successful encrypt -->
        <button id="btnClearCreate" class="btn secondary" type="button" style="display:none;">Reset</button>
      </div>

      <div id="createOutput" class="output"></div>
    </div>

    <div id="decrypt" class="pane">
      <label for="keystoreFile" style="font-size: 18px; margin-top: 10px;">Upload file</label>
      <input type="file" id="keystoreFile" accept=".json,application/json">

      <label for="keystoreJson" style="font-size: 18px; margin-top: 24px;">Keystore</label>
      <textarea id="keystoreJson" placeholder='Contents of keystore file'></textarea>

<div class="field">
  <div class="label-row">
    <label for="decryptPassword" class="field-label">Keystore password</label>
    <button
      type="button"
      id="toggleDecryptPassword"
      class="text-toggle"
    >
      Show
    </button>
  </div>

  <input
    type="password"
    id="decryptPassword"
    placeholder="Enter keystore password"
  />
</div>

      <div class="flex">
        <button id="btnDecrypt" class="btn">Unlock wallet</button>

        <!-- Hidden until successful decrypt -->
        <button id="btnClearDecrypt" class="btn secondary" type="button" style="display:none;">Reset</button>
      </div>

      <div id="decryptOutput" class="output"></div>
    </div>

  </section>
</div>

<script src="./libs/ethers.umd.min.js"></script>

<script>
  // Basic guard if ethers failed to load
  if (typeof ethers === "undefined") {
    alert("Failed to load ethers.js. For offline use, download ethers.umd.min.js and update the script src.");
  }

  // ----------------------------
  // Safe helpers (no crashes if elements are missing)
  // ----------------------------
  function $(id) {
    return document.getElementById(id);
  }

  function on(el, event, handler) {
    if (!el) return;
    el.addEventListener(event, handler);
  }

  function setOutput(el, text, type) {
    if (!el) return;
    el.textContent = text;
    el.classList.remove("success", "error");
    if (type === "success") el.classList.add("success");
    if (type === "error") el.classList.add("error");
    el.style.display = "block";
  }

  // Toggle using a BUTTON (your new compact UI)
  function attachButtonToggle(inputId, buttonId) {
    const input = $(inputId);
    const btn = $(buttonId);
    if (!input || !btn) return;

    on(btn, "click", () => {
      const visible = input.type === "text";
      input.type = visible ? "password" : "text";
      btn.textContent = visible ? "Show" : "Hide";
      btn.classList.toggle("active", !visible);
    });
  }

  // Toggle using a CHECKBOX (legacy UI - harmless if not present)
  function attachCheckboxToggle(inputId, checkboxId) {
    const input = $(inputId);
    const cb = $(checkboxId);
    if (!input || !cb) return;

    on(cb, "change", (e) => {
      input.type = e.target.checked ? "text" : "password";
    });
  }
  
  function attachTextareaToggle(textareaId, buttonId) {
  const ta = $(textareaId);
  const btn = $(buttonId);
  if (!ta || !btn) return;

  // Start hidden
  ta.style.webkitTextSecurity = "disc";

  on(btn, "click", () => {
    const hidden = ta.style.webkitTextSecurity === "disc";
    ta.style.webkitTextSecurity = hidden ? "none" : "disc";
    btn.textContent = hidden ? "Hide" : "Show";
    btn.classList.toggle("active", hidden);
  });
}

  // ----------------------------
  // Tabs
  // ----------------------------
  const tabs = document.querySelectorAll(".tab");
  const sections = document.querySelectorAll(".pane");

  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      sections.forEach(s => s.classList.remove("active"));
      tab.classList.add("active");
      const target = $(tab.dataset.target);
      if (target) target.classList.add("active");
    });
  });

  // ----------------------------
  // Password/Passphrase toggles
  // (supports both new button toggles and old checkbox toggles)
  // ----------------------------
  // NEW (button IDs) — ensure your HTML uses these IDs:
  attachButtonToggle("createPassword", "toggleCreatePassword");
  attachButtonToggle("mnemonicPassphrase", "toggleMnemonicPassphrase");
  attachButtonToggle("decryptPassword", "toggleDecryptPassword");
  attachTextareaToggle("mnemonic", "toggleMnemonic");


  // OLD (checkbox IDs) — will only attach if they exist
  attachCheckboxToggle("createPassword", "showCreatePassword");
  attachCheckboxToggle("mnemonicPassphrase", "showMnemonicPassphrase");
  attachCheckboxToggle("decryptPassword", "showDecryptPassword");

  // ----------------------------
  // CREATE KEYSTORE
  // ----------------------------
  const btnCreate = $("btnCreate");
  const btnClearCreate = $("btnClearCreate");
  const createOutput = $("createOutput");
  const downloadLink = $("downloadLink");

  function hideCreateActions() {
    if (downloadLink) {
      downloadLink.style.display = "none";
      downloadLink.removeAttribute("href");
      downloadLink.removeAttribute("download");
    }
    if (btnClearCreate) btnClearCreate.style.display = "none";
  }

  // Helpers for mnemonic -> wallet derivation (supports ethers v5 and v6 builds)
  function normalizeMnemonic(phrase) {
    return (phrase || "").trim().toLowerCase().replace(/\s+/g, " ");
  }

  function isValidMnemonic(phrase) {
    try {
      // ethers v5
      if (ethers.utils && typeof ethers.utils.isValidMnemonic === "function") {
        return ethers.utils.isValidMnemonic(phrase);
      }
      // ethers v6
      if (typeof ethers.isValidMnemonic === "function") {
        return ethers.isValidMnemonic(phrase);
      }
    } catch (_) { /* ignore */ }
    // If no validator is exposed, let derivation throw if invalid.
    return true;
  }

  function deriveWalletFromMnemonic(phrase, bip39Passphrase, derivationPath) {
    const path = (derivationPath || "").trim() || "m/44'/60'/0'/0/0";
    const pass = bip39Passphrase || "";

    // ethers v6
    if (ethers.HDNodeWallet && typeof ethers.HDNodeWallet.fromPhrase === "function") {
      return ethers.HDNodeWallet.fromPhrase(phrase, pass, path);
    }

    // ethers v5
    if (ethers.utils && ethers.utils.HDNode && typeof ethers.utils.HDNode.fromMnemonic === "function") {
      const node = ethers.utils.HDNode.fromMnemonic(phrase, pass).derivePath(path);
      return new ethers.Wallet(node.privateKey);
    }

    // fallback older v5 (no passphrase support here)
    if (ethers.Wallet && typeof ethers.Wallet.fromMnemonic === "function") {
      return ethers.Wallet.fromMnemonic(phrase, path);
    }

    throw new Error("This ethers.js build does not support mnemonic-based wallet derivation.");
  }

  on(btnCreate, "click", async () => {
    const phraseRaw = $("mnemonic") ? $("mnemonic").value : "";
    const phrase = normalizeMnemonic(phraseRaw);
    const bip39Passphrase = $("mnemonicPassphrase") ? $("mnemonicPassphrase").value : "";
    const derivationPath = ($("derivationPath") && $("derivationPath").value || "").trim() || "m/44'/60'/0'/0/0";
    const password = $("createPassword") ? $("createPassword").value : "";

    // Reset UI actions at start of a new attempt
    hideCreateActions();

    if (!phrase) {
      setOutput(createOutput, "Please enter a seed phrase (mnemonic).", "error");
      return;
    }
    if (!password) {
      setOutput(createOutput, "Please enter a password for the keystore.", "error");
      return;
    }
    if (!derivationPath.startsWith("m/")) {
      setOutput(createOutput, "Derivation path must start with m/ (example: m/44'/60'/0'/0/0).", "error");
      return;
    }
    if (!isValidMnemonic(phrase)) {
      setOutput(createOutput, "Seed phrase appears to be invalid. Please verify word order/spelling.", "error");
      return;
    }

    try {
      if (btnCreate) {
        btnCreate.disabled = true;
        btnCreate.textContent = "Encrypting...";
      }
      setOutput(createOutput, "Deriving key + encrypting... This may take a few seconds.", "success");

      const wallet = deriveWalletFromMnemonic(phrase, bip39Passphrase, derivationPath);
      const account = {
		address: wallet.address,
		privateKey: wallet.privateKey,
		// Optional, but nice to preserve if available:
		mnemonic: wallet.mnemonic && wallet.mnemonic.phrase ? {
			entropy: ethers.Mnemonic.fromPhrase(wallet.mnemonic.phrase).entropy,
			path: derivationPath
		} : undefined
	    };

		const keystoreJson = await ethers.encryptKeystoreJson(account, password, {
		scrypt: { N: 262144, r: 8, p: 1 } // increase N here
	});
      const prettyKeystore = JSON.stringify(JSON.parse(keystoreJson), null, 2);

      setOutput(
        createOutput,
        "Address: " + wallet.address + "\n" +
        "Derivation path: " + derivationPath + "\n\n" +
        "Keystore JSON:\n" + prettyKeystore,
        "success"
      );

      // Create download link with fixed name
      if (downloadLink) {
        const blob = new Blob([keystoreJson], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const filename = "keystore.json";

        downloadLink.href = url;
        downloadLink.download = filename;
        downloadLink.textContent = "Download keystore";
        downloadLink.style.display = "inline-block";
      }

      // Show Reset only after successful encrypt
      if (btnClearCreate) btnClearCreate.style.display = "inline-block";
    } catch (err) {
      console.error(err);
      setOutput(createOutput, "Error creating keystore: " + (err && err.message ? err.message : err), "error");
    } finally {
      if (btnCreate) {
        btnCreate.disabled = false;
        btnCreate.textContent = "Encrypt";
      }
    }
  });

  on(btnClearCreate, "click", () => {
    if ($("mnemonic")) $("mnemonic").value = "";
    if ($("mnemonicPassphrase")) $("mnemonicPassphrase").value = "";
    if ($("derivationPath")) $("derivationPath").value = "m/44'/60'/0'/0/0";
    if ($("createPassword")) $("createPassword").value = "";
    if (createOutput) createOutput.style.display = "none";

    if (downloadLink && downloadLink.href) {
      try { URL.revokeObjectURL(downloadLink.href); } catch (_) {}
    }
    hideCreateActions();
  });

  // ----------------------------
  // DECRYPT KEYSTORE
  // ----------------------------
  const btnDecrypt = $("btnDecrypt");
  const btnClearDecrypt = $("btnClearDecrypt");
  const decryptOutput = $("decryptOutput");
  const keystoreFileInput = $("keystoreFile");
  const keystoreJsonTextarea = $("keystoreJson");

  function hideDecryptActions() {
    if (btnClearDecrypt) btnClearDecrypt.style.display = "none";
  }

  // When a file is selected, load it into the textarea
  on(keystoreFileInput, "change", () => {
    const file = keystoreFileInput.files && keystoreFileInput.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const text = e.target.result;
        let pretty = text;
        try {
          pretty = JSON.stringify(JSON.parse(text), null, 2);
        } catch (_) { /* ignore */ }

        if (keystoreJsonTextarea) keystoreJsonTextarea.value = pretty;
      } catch (err) {
        console.error(err);
        setOutput(decryptOutput, "Failed to read file: " + err.message, "error");
      }
    };
    reader.readAsText(file);
  });

  on(btnDecrypt, "click", async () => {
    const keystoreJsonRaw = keystoreJsonTextarea ? keystoreJsonTextarea.value.trim() : "";
    const password = $("decryptPassword") ? $("decryptPassword").value : "";

    // Reset UI actions at start of a new attempt
    hideDecryptActions();

    if (!keystoreJsonRaw) {
      setOutput(decryptOutput, "Please select a keystore file or paste keystore JSON.", "error");
      return;
    }
    if (!password) {
      setOutput(decryptOutput, "Please enter the password for the keystore.", "error");
      return;
    }

    try {
      if (btnDecrypt) {
        btnDecrypt.disabled = true;
        btnDecrypt.textContent = "Decrypting...";
      }
      setOutput(decryptOutput, "Decrypting... This may take a few seconds.", "success");

      const wallet = await ethers.Wallet.fromEncryptedJson(keystoreJsonRaw, password);

      let outputText =
        "Decryption successful.\n\n" +
        "Address: " + wallet.address + "\n\n" +
        "Private key: " + wallet.privateKey;

      // In some ethers versions this is not present; show if available
      if (wallet.mnemonic && wallet.mnemonic.phrase) {
        outputText += "\n\nMnemonic phrase:\n" + wallet.mnemonic.phrase;
      }

      setOutput(decryptOutput, outputText, "success");

      // Show Reset only after successful decrypt
      if (btnClearDecrypt) btnClearDecrypt.style.display = "inline-block";
    } catch (err) {
      console.error(err);
      setOutput(
        decryptOutput,
        "Error decrypting keystore: " + (err && err.message ? err.message : err),
        "error"
      );
    } finally {
      if (btnDecrypt) {
        btnDecrypt.disabled = false;
        btnDecrypt.textContent = "Unlock Wallet";
      }
    }
  });

  on(btnClearDecrypt, "click", () => {
    if (keystoreFileInput) keystoreFileInput.value = "";
    if (keystoreJsonTextarea) keystoreJsonTextarea.value = "";
    if ($("decryptPassword")) $("decryptPassword").value = "";
    if (decryptOutput) decryptOutput.style.display = "none";
    hideDecryptActions();
  });

  // Ensure initial state is correct
  hideCreateActions();
  hideDecryptActions();
</script>

</body>
</html>






