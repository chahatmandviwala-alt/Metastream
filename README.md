# Metastream

A solution for creating Ethereum wallets and securely signing transactions offline using air-gapped devices.

<br>

![Alt text](docs/IMG_001.png)

#### Security Tip: Use this application only on a permanently air-gapped machine for maximum security.
#### Warning: Never type your cold wallet or hardware wallet seed phrase on a device that connects to the internet.

## Description

- TBC

## Features

- Completely offline
- Completely air-gapped, no wired/wiresless connections required
- Create new ethereum wallets
- Optional passphrase support
- Generate seed phrase through dice roll & coin flip
- Find the last word (checksum) for a manually generated seed phrase 
- Supports custom derivation paths (m/44'/60'/n'/)
- Encrypt and export wallet as a keystore file (UTC/JSON)
- Connect any wallet to Metamask or Rabby as a hardware wallet
- Sign transactions using QR codes.
- Virutal keyboard

<br>

## Know How To

### Create a new wallet

Choose from 12/15/18/21/24 words for the mnemonic seed phrase. Optionally use a passphrase and a custom derivation path.

A seed phrase is generated by creating cryptographically secure entropy using ethers.randomBytes(bytes) and converting that entropy into a BIP-39 mnemonic seed phrase. This ensures the resulting seed phrase has sufficient randomness for secure key generation.

<p align="center"><img src="docs/IMG_02.png" alt="Alt text" width="60%" /></p>

### Export wallet

Export the newly created wallet as an encrypted keystore file.

The keystore file encrypts the private key with a user-defined password and stores it in a UTC/JSON file. The password must be strong and securely kept. The encryption process is designed to resist brute-force attacks by making each password guess computationally expensive. Losing the password means the private keys are permanently lost. It is always recommended to also back up the seed phrase as a reliable recovery method.

<img src="docs/IMG_03.png" alt="Alt text" width="60%" />

### Dice roll & Coin flip

Do not trust the seed phrase generated by a machine? Use this tool generate a seed phrase using 5 dice rolls and a coin flip. 

The method generates seed entropy using physical randomness from dice rolls and coin flips, which are mapped to BIP-39 words using a predefined table. The predefined table can be found [here](https://bitbox.swiss/bitbox02/BitBox_Diceware_LookupTable.pdf). This process determines the first words (n-1) of the seed phrase, while the final word is calculated as the checksum.

<img src="docs/IMG_04.png" alt="Alt text" width="60%" />

### Find last (checksum) seed word 

Find the last word for a manually generated seed phrase. Enter n-1 words generated using dice roll & coin flip or any other method. Choose a word from the list all valid last words that satisfy the checksum. 

<img src="docs/IMG_05.png" alt="Alt text" width="60%" />

### Connect wallet

Connect a newly created wallet or any other wallet to Metamask or Rabby as a hardware wallet. 

<img src="docs/IMG_06.png" alt="Alt text" width="60%" />

Obtian a BC-UR encoded CRYPTO-HDKEY from a seed phrase (optional passphrase and custom derivation path). Using UR:CRYPTO-HDKEY QR codes, any wallet can interact with MetaMask or Rabby in the same way as a hardware wallet (e.g. Keystone, Onekey, nGRAVE), effectively emulating hardware wallet behavior without a direct physical connection and without exposing the private keys. 

<img src="docs/IMG_07.png" alt="Alt text" width="60%" />

Scan the generated UR:CRYPTO-HDKEY QR code with Metamask or Rabby to connect the wallet.

<img src="docs/IMG_08.png" alt="Alt text" width="85%" />

## Security

The security concept behind using air-gapped systems for signing transactions is to work with two physically separated devices, one of which has no connection to the outside world or any network. In this context, connecting your wallet with Metamask/Rabby allows you to watch your wallet and sign transactions through one-way communication using QR codes.

## Build

Clone the repo:

```bash
git clone https://github.com/chahatmandviwala-alt/Metastream.git
```


Install the dependencies:

```bash
npm install
```

Run locally in any browser:

```bash
npm run start
```

Alternatively run locally in default browser:

```bash
./Metastream.bat
```


## Disclosing Security Vulnerabilities

If you discover a security vulnerability within this application, please send an e-mail to chahat.mandviwala@gmail.com. All security vulnerabilities will be promptly addressed.

